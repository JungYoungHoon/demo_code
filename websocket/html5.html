<!doctype html>
<html>
<head>
  <title>Spinning HTML5Logo</title>
  <link rel="stylesheet" href="http://www.appelsiini.net/stylesheets/screen.css">
  <link rel="stylesheet" href="http://www.appelsiini.net/attachments/styles.css">
  <link href="http://feeds.feedburner.com/tuupola" rel="alternate" type="application/atom+xml">
  <link href="http://www.myopenid.com/server" rel="openid.server">
  <link href="http://tuupola.myopenid.com/" rel="openid.delegate">
  <meta content="kpdZZm3glgPWE++IGp64scG0ymM5JEHVKe2HlH8Rm18=" name="verify-v1">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript" charset="utf-8"></script>
  <style>
   /*
    * Spinning HTML5Logo Demo
    * by @boazsender: http://boazsender.com
    * Thanks to http://webkit.org/blog/386/3d-transforms/
    *
    */ 
    
    @-webkit-keyframes none {
    }
    
    @-webkit-keyframes elevator-down {
      0%    { -webkit-transform: rotateX(0deg); }
      50%   { -webkit-transform: rotateX(180deg); }
      100%  { -webkit-transform: rotateX(360deg); }
    }

    @-webkit-keyframes elevator-up {
      0%    { -webkit-transform: rotateX(360deg); }
      50%   { -webkit-transform: rotateX(180deg); }
      100%  { -webkit-transform: rotateX(0deg); }
    }

    @-webkit-keyframes aileron-right {
      0%    { -webkit-transform: rotateZ(0deg); }
      50%   { -webkit-transform: rotateZ(180deg); }
      100%  { -webkit-transform: rotateZ(360deg); }
    }

    @-webkit-keyframes aileron-left {
      0%    { -webkit-transform: rotateZ(360deg); }
      50%   { -webkit-transform: rotateZ(180deg); }
      100%  { -webkit-transform: rotateZ(0deg); }
    }

    @-webkit-keyframes pitch-right {
      0%    { -webkit-transform: rotateY(360deg); }
      50%   { -webkit-transform: rotateY(180deg); }
      100%  { -webkit-transform: rotateY(0deg); }
    }
    
    @-webkit-keyframes pitch-left {
      0%    { -webkit-transform: rotateY(0deg); }
      50%   { -webkit-transform: rotateY(180deg); }
      100%  { -webkit-transform: rotateY(360deg); }
    }

    body {
      -webkit-perspective: 800; 
      overflow: hidden;
    }
    
    div {
      -webkit-transition-duration: 1s;
      -transition-timing-function: linear;
    }
    
    #elevator {
      -webkit-perspective-origin: 50% 50%;
      -webkit-transform-style: preserve-3d;
      /*-webkit-animation: x-spin 10s infinite linear;*/
      -webkit-transition: -webkit-transform 1s linear
      position: relative;
      top: 200px;
      margin: 0 auto;
      width: 200px;
    }
    
    #pitch {
      -webkit-transform-style: preserve-3d;
      -webkit-animation-name: z-spin;
      -webkit-animation-duration: 5s;
      -webkit-animation-iteration-count: infinite;
      -webkit-animation-timing-function: linear;
    }
    
    #aileron {
      -webkit-transform-style: preserve-3d;
      -webkit-animation-name: y-spin;
      -webkit-animation-duration: 5s;
      -webkit-animation-iteration-count: infinite;
      -webkit-animation-timing-function: linear;
    }
    
    #aileron > img {
      -webkit-backface-visibility: visible;
      position: absolute;
      height: 120px;
      -webkit-transition: all .4s;
      border: 0px solid #fff;
    }

    #aileron > img.a {
      height: 260px;
      top: -80px;
      right: -5px;
    }
    
    img:hover{
      -webkit-transform: translateZ(0px);
    }

    .a { -webkit-transform: }
    .b { -webkit-transform: rotateY(0deg)   translateZ(200px); }
    .c { -webkit-transform: rotateY(45deg)  translateZ(200px); }
    .d { -webkit-transform: rotateY(90deg)  translateZ(200px); }
    .e { -webkit-transform: rotateY(135deg) translateZ(200px); }
    .f { -webkit-transform: rotateY(180deg) translateZ(200px); }
    .g { -webkit-transform: rotateY(215deg) translateZ(200px); }
    .h { -webkit-transform: rotateY(260deg) translateZ(200px); }
    .i { -webkit-transform: rotateY(305deg) translateZ(200px); }
    .j { -webkit-transform: rotateY(360deg) translateZ(200px); }
    
  </style>
</head>
<body>

<div class="container">
  <div class="span-20" id="header">
    <div class="span-14">
    <h1>iPhone Contaileroned Cube</h1>
    <p>Technology guy with passion for advertising.</p>
  </div>

  <div class="span-6 last">
    <ul id="nav">
      <li id="first"><a href="/">weblog</a></li>
      <li><a class="last" href="/projects">projects</a></li>
    </ul>
  </div>

  <div class="span-20" id="content">        
    <p id="instructions" class="notice">
      You can control this cube by tilting your iPhone. First you must pair your iPhone and desktop browser. 
      With your iPhone go to address <b><a href="http://appelsiini.net/demo/websocket/iphone.html">appelsiini.net/ws</a></b>
      and enter PIN code <b id="pin">xxxx</b>. 
    </p>

    <p id="connected" class="success" style="display:none;">
      Now try tilting your iPhone. The more you tilt the faster the cube will rotate.
      Response rate has been degraded on purpose to prevent mobile browser sending data 
      50 times per second.
    </p>
    
    <div id="elevator">
      <div id="pitch">
        <div id="aileron">
        <img class="a" src="img/HTML5_Logo_512.png">
        <img class="b" src="img/HTML5_3D_Effects_512.png" >
        <img class="c" src="img/HTML5_Connectivity_512.png">
        <img class="d" src="img/HTML5_Device_Access_512.png">
        <img class="e" src="img/HTML5_Multimedia_512.png">
        <img class="f" src="img/HTML5_Offline_Storage_512.png">
        <img class="g" src="img/HTML5_Performance_512.png">
        <img class="h" src="img/HTML5_Semantics_512.png">
        <img class="i" src="img/HTML5_Styling_512.png">
        </div>
      </div>
    </div>
    
  </div>
</div>
<div id="footer"></div>  

<script type="text/javascript" charset="utf-8">
$(function() {

    /* Stop the animations. */
    $("#elevator").css("-webkitAnimationName", "none");
    $("#aileron").css("-webkitAnimationName", "none");
    $("#pitch").css("-webkitAnimationName", "none");
    
    function pad(number, length) {
      
        var str = '' + number;
        while (str.length < length) {
            str = '0' + str;
        }

        return str;
    }

    var pin = pad(Math.floor(Math.random() * 9999), 4);
    $("#pin").text(pin);

    var socket = new WebSocket("ws://ws.appelsiini.net:8080/iphone/" + pin);
    //var socket = new WebSocket("ws://ws.appelsiini.net:8080/iphone");

    socket.onopen = function(event) {
    };

    socket.onmessage = function(event) {
        var payload = JSON.parse(event.data);
        if (payload.data) {
            if ("orientation" == payload.type) {
                $("#elevator").css("-webkit-transform", "rotateX(" + payload.data.x * -1 + "deg)");
                $("#aileron").css("-webkit-transform", "rotateZ(" + payload.data.y * 1 + "deg)");
                $("#pitch").css("-webkit-transform", "rotateY(" + payload.data.z * 1 + "deg)");              
            } else {
                $("#elevator").css("-webkit-transform", "rotateX(" + payload.data.y * 1 + "deg)");
                $("#aileron").css("-webkit-transform", "rotateZ(" + payload.data.x * 1 + "deg)");
            }
        }
        if (payload.server) {
            if (payload.server.match(/disconnected/)) {
                $("#instructions").show();
                $("#connected").hide();  
                $("#elevator").css("-webkit-transform", "rotateX(0deg)");
                $("#aileron").css("-webkit-transform", "rotateZ(0deg)");
                $("#pitch").css("-webkit-transform", "rotateY(0deg)");  
            }
        }
        if (payload.mobile) {
            if ("Mobile connected" == payload.mobile) {
                $("#instructions").hide();
                $("#connected").show();                    
            }
        }
    };

    socket.onclose = function(event) {
    };

});
</script>
    
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-190966-1']);
_gaq.push(['_trackPageview']);
(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>


</body>
</html>  